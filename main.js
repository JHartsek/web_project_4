(()=>{"use strict";var e="";const t=e+"50fce9df697a07971411.svg",n=e+"7a0b85df4e06c9be0cf6.jpg",o=e+"8f7af7ee8641b74b1e28.jpg";function r(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var u=function(){function e(t,n,o){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),i(this,"_handleDelete",(function(){r._post.remove(),r._post=null})),i(this,"_handleLike",(function(e){e.target.classList.toggle("post__caption-like__button_active")})),this._title=t.title,this._link=t.link,this.templateSelector=n,this._handleCardClick=o}var t,n;return t=e,(n=[{key:"_getTemplate",value:function(){return this._postTemplateElement=document.querySelector(this.templateSelector),this._postTemplate=this._postTemplateElement.content,this._postElement=this._postTemplate.querySelector(".post").cloneNode(!0),this._postElement}},{key:"createPost",value:function(){return this._post=this._getTemplate(),this._postImageElement=this._post.querySelector(".post__image"),this._postImageElement.setAttribute("src",this._link),this._postImageElement.setAttribute("alt",this._title),this._postCaptionTextElement=this._post.querySelector(".post__caption-text"),this._postCaptionTextElement.textContent=this._title,this._setEventListeners(),this._post}},{key:"_setEventListeners",value:function(){var e=this;this._deleteButton=this._post.querySelector(".post__delete"),this._deleteButton.addEventListener("click",this._handleDelete),this._image=this._post.querySelector(".post__image"),this._image.addEventListener("click",(function(){e._handleCardClick(e._title,e._link)})),this._likeButton=this._post.querySelector(".post__caption-like__button"),this._likeButton.addEventListener("click",this._handleLike)}}])&&r(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function a(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function s(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var c=s((function e(t,n){var o=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),l(this,"_showInputError",(function(e,t){var n=o._formElement.querySelector(".".concat(e.id,"-input-error"));e.classList.add(o._inputErrorClass),n.textContent=t,n.classList.add(o._errorClass)})),l(this,"_hideInputError",(function(e){var t=o._formElement.querySelector(".".concat(e.id,"-input-error"));e.classList.remove(o._inputErrorClass),t.textContent=" ",t.classList.remove(o._errorClass)})),l(this,"_checkInputValidity",(function(e){e.validity.valid?o._hideInputError(e):o._showInputError(e,e.validationMessage)})),l(this,"_hasInvalidInput",(function(){return o._formInputs.some((function(e){return!e.validity.valid}))})),l(this,"resetValidation",(function(){o.toggleSubmitButton(),o._formInputs.forEach((function(e){o._hideInputError(e)}))})),l(this,"toggleSubmitButton",(function(){o._hasInvalidInput(o._formInputs)?(o._submitButton.classList.add(o._inactiveButtonClass),o._submitButton.setAttribute("disabled",!0)):(o._submitButton.classList.remove(o._inactiveButtonClass),o._submitButton.removeAttribute("disabled"))})),l(this,"_setEventListeners",(function(){o.toggleSubmitButton(o._formInputs,o._submitButton),o._formInputs.forEach((function(e){e.addEventListener("input",(function(){o._checkInputValidity(e),o.toggleSubmitButton(o._formInputs,o._submitButton)}))}))})),l(this,"enableValidation",(function(){o._formElement.addEventListener("submit",(function(e){e.preventDefault()})),o._setEventListeners()})),this._inputSelector=t.inputSelector,this._submitButtonSelector=t.submitButtonSelector,this._inactiveButtonClass=t.inactiveButtonClass,this._inputErrorClass=t.inputErrorClass,this._errorClass=t.errorClass,this._formElement=n,this._submitButton=this._formElement.querySelector(this._submitButtonSelector),this._formInputs=Array.from(this._formElement.querySelectorAll(this._inputSelector))}));function f(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function p(e,t,n){return t&&f(e.prototype,t),n&&f(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var m=p((function e(t,n){var o=this,r=t.items,i=t.renderer;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),d(this,"renderElements",(function(){o._items.forEach((function(e){o._renderer(e)}))})),d(this,"addItem",(function(e){o._container.prepend(e)})),this._items=r,this._renderer=i,this._container=document.querySelector(n)}));function _(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var b=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),h(this,"_handleOverlayClick",(function(e){e.target===e.currentTarget&&n.close()})),h(this,"_handleEscClose",(function(e){"Escape"===e.key&&n.close()})),this._popupSelector=t,this._popupElement=document.querySelector(t),this._closeButton=this._popupElement.querySelector(".popup__close-button")}var t,n;return t=e,(n=[{key:"open",value:function(){this._popupElement.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose)}},{key:"close",value:function(){this._popupElement.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}},{key:"setEventListeners",value:function(){var e=this;this._closeButton.addEventListener("click",(function(){e.close()})),this._popupElement.addEventListener("mousedown",this._handleOverlayClick)}}])&&_(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function y(e){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y(e)}function v(e,t){return v=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},v(e,t)}function g(e,t){if(t&&("object"===y(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return E(e)}function E(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function w(){return w="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var o=S(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(arguments.length<3?e:n):r.value}},w.apply(this,arguments)}function S(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=O(e)););return e}function O(e){return O=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},O(e)}function j(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var k=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&v(e,t)}(i,e);var t,n,o,r=(n=i,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=O(n);if(o){var r=O(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return g(this,e)});function i(e,t,n){var o,u;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),j(E(u=r.call(this,e)),"_setImagePopupAttributes",(function(e,t){u._image.setAttribute("src",t),u._image.setAttribute("alt",e),u._imageCaption.textContent=e})),j(E(u),"open",(function(e,t){w((o=E(u),O(i.prototype)),"open",o).call(o),u._setImagePopupAttributes(e,t)})),u._image=document.querySelector(".popup__image"),u._imageCaption=document.querySelector(".popup__image-caption"),u}return t=i,Object.defineProperty(t,"prototype",{writable:!1}),t}(b);function C(e){return C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},C(e)}function P(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function I(e,t){return I=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},I(e,t)}function L(e,t){if(t&&("object"===C(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return B(e)}function B(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function q(){return q="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var o=x(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(arguments.length<3?e:n):r.value}},q.apply(this,arguments)}function x(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=T(e)););return e}function T(e){return T=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},T(e)}function R(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var A=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&I(e,t)}(u,e);var t,n,o,r,i=(o=u,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=T(o);if(r){var n=T(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return L(this,e)});function u(e,t){var n,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),R(B(o=i.call(this,e)),"getInputValues",(function(){return o._userInputs={},o._inputFields.forEach((function(e){o._userInputs[e.name]=e.value})),o._userInputs})),R(B(o),"close",(function(){q((n=B(o),T(u.prototype)),"close",n).call(n),o._form.reset()})),o._form=o._popupElement.querySelector(".form"),o._submitHandler=t,o._inputFields=o._form.querySelectorAll(".form__input"),o}return t=u,(n=[{key:"setEventListeners",value:function(){q(T(u.prototype),"setEventListeners",this).call(this),this._form.addEventListener("submit",this._submitHandler)}}])&&P(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(b);function V(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var D=function(){function e(t){var n=t.nameElementSelector,o=t.aboutElementSelector;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._profileNameElement=document.querySelector(n),this._profileAboutMeElement=document.querySelector(o)}var t,n;return t=e,(n=[{key:"getUserInfo",value:function(){return this._currentUserInfo={name:this._profileNameElement.textContent,about:this._profileAboutMeElement.textContent},this._currentUserInfo}},{key:"setUserInfo",value:function(e,t){this._profileNameElement.textContent=e,this._profileAboutMeElement.textContent=t}}])&&V(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function U(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var z=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._baseUrl=t.url,this._authorization=t.authorization}var t,n;return t=e,(n=[{key:"loadUserInfo",value:function(){fetch("".concat(this._baseUrl,"/users/me"),{headers:{authorization:this._authorization}}).then((function(e){e.json()})).then((function(e){console.log(e)}))}},{key:"getInitialCards",value:function(){}}])&&U(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),M=document.querySelector(".profile__info-edit-button"),N=document.querySelector(".profile-edit-form"),F=document.querySelector("#name"),H=document.querySelector("#about-me"),Y=document.querySelector(".profile__add-button"),G=document.querySelector(".add-post-form"),J={formSelector:".form",inputSelector:".form__input",submitButtonSelector:".form__save-button",inactiveButtonClass:"form__save-button_disabled",inputErrorClass:"form__input_type_invalid",errorClass:"form__input-error_active"},K=document.querySelector("#logo-image"),Q=document.querySelector("#avatar-image"),W=document.querySelector("#initial-popup-image"),X=new k("#focus-image-popup");function Z(e){return new u(e,".template__post",(function(e,t){X.open(e,t)})).createPost()}X.setEventListeners();var $=new m({items:[{title:"Lago di Braies",link:"https://code.s3.yandex.net/web-code/lago.jpg"},{title:"Vanoise National Park",link:"https://code.s3.yandex.net/web-code/vanoise.jpg"},{title:"Latemar",link:"https://code.s3.yandex.net/web-code/latemar.jpg"},{title:"Bald Mountains",link:"https://code.s3.yandex.net/web-code/bald-mountains.jpg"},{title:"Lake Louise",link:"https://code.s3.yandex.net/web-code/lake-louise.jpg"},{title:"Yosemite Valley",link:"https://code.s3.yandex.net/web-code/yosemite.jpg"}],renderer:function(e){var t=Z(e);$.addItem(t)}},".posts-grid");$.renderElements();var ee=new c(J,G);ee.enableValidation();var te=new c(J,N);te.enableValidation();var ne=new A("#edit-profile-popup",(function(e){e.preventDefault();var t=ne.getInputValues();re.setUserInfo(t.name,t["about-me"]),ne.close()}));ne.setEventListeners();var oe=new A("#add-post-popup",(function(e){e.preventDefault();var t=Z(oe.getInputValues());$.addItem(t),oe.close()}));oe.setEventListeners();var re=new D({nameElementSelector:".profile__info-name",aboutElementSelector:".profile__info-descriptor"});Y.addEventListener("click",(function(){ee.resetValidation(),oe.open()})),M.addEventListener("click",(function(){var e;te.resetValidation(),ne.open(),e=re.getUserInfo(),F.value=e.name,H.value=e.about})),K.src=t,Q.src=n,W.src=o,new z({url:"https://around.nomoreparties.co/v1/group-12",authorization:"382934e9-5d13-46b8-8892-13e8f13d57ff"})})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFlRCxHQUFpQkUsaUJBQ3RDQyxHQUFLQyxZQUFZSCxFQUFhdkQsS0FBTXVELEVBQWEsYUFDakRELEdBQWlCL0QsV0F6Qm5CK0QsR0FBaUJQLG9CQUNqQixJQUFNWSxHQUFlLElBQUl4RCxFQUFjLG1CQWlDdkMsU0FBMEI1RixHQUN4QkEsRUFBTXdELGlCQUNOLElBQ01rQixFQUFVMkQsRUFES2UsR0FBYUgsa0JBRWxDUixFQUFZQyxRQUFRaEUsR0FDcEIwRSxHQUFhcEUsV0FyQ2ZvRSxHQUFhWixvQkFJYixJQUFNVSxHQUFPLElBQUk5QyxFQUFVLENBQ3pCQyxvQkFBcUIsc0JBQ3JCQyxxQkFBc0IsOEJBbUN4QnVCLEVBQWNyRyxpQkFBaUIsU0FBUyxXQUN0Q29ILEdBQWtCUyxrQkFibEJELEdBQWFkLFVBZ0JmYixFQUFrQmpHLGlCQUFpQixTQUFTLFdBL0I1QyxJQUxROEgsRUFxQ05SLEdBQXNCTyxrQkEvQnRCTixHQUFpQlQsT0FOWGdCLEVBQWtCSixHQUFLSyxjQUM3QjVCLEVBQVUzQixNQUFRc0QsRUFBZ0I3RCxLQUNsQ21DLEVBQVc1QixNQUFRc0QsRUFBZ0I1QyxTQXlDckN1QixFQUFpQnVCLElBQU1DLEVBQ3ZCdkIsRUFBbUJzQixJQUFNRSxFQUN6QnZCLEVBQXlCcUIsSUFBTUcsRUFFbkIsSUFBSWhELEVBQUksQ0FBQ0csSUFBSyw4Q0FBK0NFLGNBQWUsMEMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80L3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvd2VicGFjay9ydW50aW1lL3B1YmxpY1BhdGgiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL0FwaS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3BhZ2VzL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIFRoZSByZXF1aXJlIHNjb3BlXG52YXIgX193ZWJwYWNrX3JlcXVpcmVfXyA9IHt9O1xuXG4iLCJfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiOyIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xuICBjb25zdHJ1Y3RvcihkYXRhLCB0ZW1wbGF0ZVNlbGVjdG9yLCBoYW5kbGVDYXJkQ2xpY2spIHtcbiAgICB0aGlzLl90aXRsZSA9IGRhdGEudGl0bGU7XG4gICAgdGhpcy5fbGluayA9IGRhdGEubGluaztcbiAgICB0aGlzLnRlbXBsYXRlU2VsZWN0b3IgPSB0ZW1wbGF0ZVNlbGVjdG9yO1xuICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljayA9IGhhbmRsZUNhcmRDbGljazsgXG4gIH1cblxuICBfZ2V0VGVtcGxhdGUoKSB7XG4gICAgdGhpcy5fcG9zdFRlbXBsYXRlRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy50ZW1wbGF0ZVNlbGVjdG9yKTtcbiAgICB0aGlzLl9wb3N0VGVtcGxhdGUgPSB0aGlzLl9wb3N0VGVtcGxhdGVFbGVtZW50LmNvbnRlbnQ7XG4gICAgdGhpcy5fcG9zdEVsZW1lbnQgPSB0aGlzLl9wb3N0VGVtcGxhdGUucXVlcnlTZWxlY3RvcihcIi5wb3N0XCIpLmNsb25lTm9kZSh0cnVlKTtcbiAgICByZXR1cm4gdGhpcy5fcG9zdEVsZW1lbnQ7XG4gIH1cblxuICBjcmVhdGVQb3N0KCkge1xuICAgIHRoaXMuX3Bvc3QgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xuICAgIHRoaXMuX3Bvc3RJbWFnZUVsZW1lbnQgPSB0aGlzLl9wb3N0LnF1ZXJ5U2VsZWN0b3IoXCIucG9zdF9faW1hZ2VcIik7XG4gICAgdGhpcy5fcG9zdEltYWdlRWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJzcmNcIiwgdGhpcy5fbGluayk7XG4gICAgdGhpcy5fcG9zdEltYWdlRWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJhbHRcIiwgdGhpcy5fdGl0bGUpO1xuICAgIHRoaXMuX3Bvc3RDYXB0aW9uVGV4dEVsZW1lbnQgPSB0aGlzLl9wb3N0LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBcIi5wb3N0X19jYXB0aW9uLXRleHRcIlxuICAgICk7XG4gICAgdGhpcy5fcG9zdENhcHRpb25UZXh0RWxlbWVudC50ZXh0Q29udGVudCA9IHRoaXMuX3RpdGxlO1xuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgcmV0dXJuIHRoaXMuX3Bvc3Q7XG4gIH1cblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fZGVsZXRlQnV0dG9uID0gdGhpcy5fcG9zdC5xdWVyeVNlbGVjdG9yKFwiLnBvc3RfX2RlbGV0ZVwiKTtcbiAgICB0aGlzLl9kZWxldGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuX2hhbmRsZURlbGV0ZSk7XG5cbiAgICB0aGlzLl9pbWFnZSA9IHRoaXMuX3Bvc3QucXVlcnlTZWxlY3RvcihcIi5wb3N0X19pbWFnZVwiKTtcbiAgICB0aGlzLl9pbWFnZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrKHRoaXMuX3RpdGxlLCB0aGlzLl9saW5rKTtcbiAgICB9KVxuXG4gICAgdGhpcy5fbGlrZUJ1dHRvbiA9IHRoaXMuX3Bvc3QucXVlcnlTZWxlY3RvcihcIi5wb3N0X19jYXB0aW9uLWxpa2VfX2J1dHRvblwiKTtcbiAgICB0aGlzLl9saWtlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLl9oYW5kbGVMaWtlKTtcbiAgfVxuXG4gIF9oYW5kbGVEZWxldGUgPSAoKSA9PiB7XG4gICAgdGhpcy5fcG9zdC5yZW1vdmUoKTtcbiAgICB0aGlzLl9wb3N0ID0gbnVsbDtcbiAgfTtcblxuICBfaGFuZGxlTGlrZSA9IChldmVudCkgPT4ge1xuICAgIGV2ZW50LnRhcmdldC5jbGFzc0xpc3QudG9nZ2xlKFwicG9zdF9fY2FwdGlvbi1saWtlX19idXR0b25fYWN0aXZlXCIpO1xuICB9O1xufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgRm9ybVZhbGlkYXRvciB7XG4gICAgY29uc3RydWN0b3Ioc2V0dGluZ3MsIGZvcm1FbGVtZW50KSB7XG4gICAgICAgIHRoaXMuX2lucHV0U2VsZWN0b3IgPSBzZXR0aW5ncy5pbnB1dFNlbGVjdG9yO1xuICAgICAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvciA9IHNldHRpbmdzLnN1Ym1pdEJ1dHRvblNlbGVjdG9yO1xuICAgICAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gc2V0dGluZ3MuaW5hY3RpdmVCdXR0b25DbGFzcztcbiAgICAgICAgdGhpcy5faW5wdXRFcnJvckNsYXNzID0gc2V0dGluZ3MuaW5wdXRFcnJvckNsYXNzO1xuICAgICAgICB0aGlzLl9lcnJvckNsYXNzID0gc2V0dGluZ3MuZXJyb3JDbGFzczsgXG4gICAgICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gZm9ybUVsZW1lbnQ7IFxuICAgICAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcbiAgICAgICAgdGhpcy5fZm9ybUlucHV0cyA9IEFycmF5LmZyb20odGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKSk7XG4gICAgfSBcblxuICAgIF9zaG93SW5wdXRFcnJvciA9IChpbnB1dEVsZW1lbnQsIGVycm9yTWVzc2FnZSkgPT4ge1xuICAgICAgICBjb25zdCBlcnJvck1lc3NhZ2VFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihgLiR7aW5wdXRFbGVtZW50LmlkfS1pbnB1dC1lcnJvcmApO1xuICAgICAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xuICAgICAgICBlcnJvck1lc3NhZ2VFbGVtZW50LnRleHRDb250ZW50ID0gZXJyb3JNZXNzYWdlO1xuICAgICAgICBlcnJvck1lc3NhZ2VFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fZXJyb3JDbGFzcyk7XG4gICAgfVxuXG4gICAgX2hpZGVJbnB1dEVycm9yID0gKGlucHV0RWxlbWVudCkgPT4ge1xuICAgICAgICBjb25zdCBlcnJvck1lc3NhZ2VFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihgLiR7aW5wdXRFbGVtZW50LmlkfS1pbnB1dC1lcnJvcmApO1xuICAgICAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpOyBcbiAgICAgICAgZXJyb3JNZXNzYWdlRWxlbWVudC50ZXh0Q29udGVudCA9IFwiIFwiO1xuICAgICAgICBlcnJvck1lc3NhZ2VFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZXJyb3JDbGFzcyk7XG4gICAgfVxuXG4gICAgX2NoZWNrSW5wdXRWYWxpZGl0eSA9IChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICAgICAgaWYoIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xuICAgICAgICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50LCBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2UpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBcbiAgICBfaGFzSW52YWxpZElucHV0ID0gKCkgPT57XG4gICAgICAgIHJldHVybiB0aGlzLl9mb3JtSW5wdXRzLnNvbWUoKGlucHV0KSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gIWlucHV0LnZhbGlkaXR5LnZhbGlkO1xuICAgICAgICB9KVxuICAgIH1cblxuICAgIHJlc2V0VmFsaWRhdGlvbiA9ICgpID0+IHtcbiAgICAgICAgdGhpcy50b2dnbGVTdWJtaXRCdXR0b24oKTtcbiAgICAgICAgdGhpcy5fZm9ybUlucHV0cy5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICAgICAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgdG9nZ2xlU3VibWl0QnV0dG9uID0gKCkgPT4ge1xuICAgICAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KHRoaXMuX2Zvcm1JbnB1dHMpKSB7XG4gICAgICAgICAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICAgICAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2Rpc2FibGVkJywgdHJ1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICAgICAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5yZW1vdmVBdHRyaWJ1dGUoJ2Rpc2FibGVkJyk7IFxuICAgICAgICB9XG4gICAgfVxuXG4gICAgX3NldEV2ZW50TGlzdGVuZXJzID0gKCkgPT4ge1xuICAgICAgICB0aGlzLnRvZ2dsZVN1Ym1pdEJ1dHRvbih0aGlzLl9mb3JtSW5wdXRzLCB0aGlzLl9zdWJtaXRCdXR0b24pO1xuICAgICAgICB0aGlzLl9mb3JtSW5wdXRzLmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xuICAgICAgICAgICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpO1xuICAgICAgICAgICAgICAgIHRoaXMudG9nZ2xlU3VibWl0QnV0dG9uKHRoaXMuX2Zvcm1JbnB1dHMsIHRoaXMuX3N1Ym1pdEJ1dHRvbik7XG4gICAgICAgICAgICB9KVxuICAgICAgICB9KVxuICAgIH1cblxuICAgIGVuYWJsZVZhbGlkYXRpb24gPSAoKSA9PiB7XG4gICAgICAgIHRoaXMuX2Zvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIChldnQpID0+IHtcbiAgICAgICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICB9KVxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgfVxufSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xuICAgIGNvbnN0cnVjdG9yICh7IGl0ZW1zLCByZW5kZXJlciB9LCBjb250YWluZXJTZWxlY3Rvcikge1xuICAgICAgICB0aGlzLl9pdGVtcyA9IGl0ZW1zO1xuICAgICAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xuICAgICAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lclNlbGVjdG9yKTsgXG4gICAgfVxuXG4gICAgcmVuZGVyRWxlbWVudHMgPSAoKSA9PiB7XG4gICAgICAgIHRoaXMuX2l0ZW1zLmZvckVhY2goaXRlbSA9PiB7XG4gICAgICAgICAgICB0aGlzLl9yZW5kZXJlcihpdGVtKTtcbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICBhZGRJdGVtID0gKGVsZW1lbnQpID0+IHtcbiAgICAgICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoZWxlbWVudCk7XG4gICAgfVxufSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwIHtcbiAgICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XG4gICAgICAgIHRoaXMuX3BvcHVwU2VsZWN0b3IgPSBwb3B1cFNlbGVjdG9yO1xuICAgICAgICB0aGlzLl9wb3B1cEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xuICAgICAgICB0aGlzLl9jbG9zZUJ1dHRvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2Nsb3NlLWJ1dHRvbicpO1xuICAgIH1cblxuICAgIG9wZW4gKCkge1xuICAgICAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LmFkZCgncG9wdXBfb3BlbmVkJyk7XG4gICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gICAgfVxuXG4gICAgY2xvc2UgKCkge1xuICAgICAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgncG9wdXBfb3BlbmVkJyk7XG4gICAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gICAgfVxuXG4gICAgX2hhbmRsZU92ZXJsYXlDbGljayA9IChldnQpID0+IHtcbiAgICAgICAgaWYgKGV2dC50YXJnZXQgPT09IGV2dC5jdXJyZW50VGFyZ2V0KSB7XG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7IFxuICAgICAgICB9XG4gICAgfVxuICBcbiAgICBfaGFuZGxlRXNjQ2xvc2UgPSAoZXZ0KSA9PiB7XG4gICAgICAgIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7IFxuICAgICAgICB9XG4gICAgfVxuXG4gICAgc2V0RXZlbnRMaXN0ZW5lcnMgKCkgeyBcbiAgICAgICAgdGhpcy5fY2xvc2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5fcG9wdXBFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIHRoaXMuX2hhbmRsZU92ZXJsYXlDbGljayk7XG4gICAgfVxufVxuICAiLCJpbXBvcnQgUG9wdXAgZnJvbSAnLi9Qb3B1cC5qcyc7IFxuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHsgXG4gICAgY29uc3RydWN0b3IocG9wdXBTZWxlY3RvciwgdGl0bGUsIGxpbmspIHtcbiAgICAgICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XG4gICAgICAgIHRoaXMuX2ltYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX19pbWFnZScpO1xuICAgICAgICB0aGlzLl9pbWFnZUNhcHRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2ltYWdlLWNhcHRpb24nKTtcbiAgICB9XG5cbiAgICBfc2V0SW1hZ2VQb3B1cEF0dHJpYnV0ZXMgPSAobmFtZSwgbGluaykgPT4ge1xuICAgICAgICB0aGlzLl9pbWFnZS5zZXRBdHRyaWJ1dGUoJ3NyYycsIGxpbmspO1xuICAgICAgICB0aGlzLl9pbWFnZS5zZXRBdHRyaWJ1dGUoJ2FsdCcsIG5hbWUpO1xuICAgICAgICB0aGlzLl9pbWFnZUNhcHRpb24udGV4dENvbnRlbnQgPSBuYW1lO1xuICAgIH1cblxuICAgIG9wZW4gPSAobmFtZSwgbGluaykgPT4geyBcbiAgICAgICAgc3VwZXIub3BlbigpO1xuICAgICAgICB0aGlzLl9zZXRJbWFnZVBvcHVwQXR0cmlidXRlcyhuYW1lLCBsaW5rKTtcbiAgICB9XG59IiwiaW1wb3J0IFBvcHVwIGZyb20gJy4vUG9wdXAuanMnOyBcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcbiAgICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCBzdWJtaXRIYW5kbGVyKSB7XG4gICAgICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xuICAgICAgICB0aGlzLl9mb3JtID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5mb3JtJyk7XG4gICAgICAgIHRoaXMuX3N1Ym1pdEhhbmRsZXIgPSBzdWJtaXRIYW5kbGVyO1xuICAgICAgICB0aGlzLl9pbnB1dEZpZWxkcyA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvckFsbCgnLmZvcm1fX2lucHV0Jyk7XG4gICAgfVxuXG4gICAgZ2V0SW5wdXRWYWx1ZXMgPSAoKSA9PiB7XG4gICAgICAgIHRoaXMuX3VzZXJJbnB1dHMgPSB7fTtcbiAgICAgICAgdGhpcy5faW5wdXRGaWVsZHMuZm9yRWFjaChpbnB1dCA9PiB7XG4gICAgICAgICAgICB0aGlzLl91c2VySW5wdXRzW2lucHV0Lm5hbWVdID0gIGlucHV0LnZhbHVlOyBcbiAgICAgICAgfSlcbiAgICAgICAgcmV0dXJuIHRoaXMuX3VzZXJJbnB1dHM7XG4gICAgfVxuXG4gICAgc2V0RXZlbnRMaXN0ZW5lcnMgKCkge1xuICAgICAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuICAgICAgICB0aGlzLl9mb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIHRoaXMuX3N1Ym1pdEhhbmRsZXIpO1xuICAgIH1cblxuICAgIGNsb3NlID0gKCkgPT4ge1xuICAgICAgICBzdXBlci5jbG9zZSgpOyBcbiAgICAgICAgdGhpcy5fZm9ybS5yZXNldCgpO1xuICAgIH1cbn0iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyB1c2VySW5mbyB7XG4gICAgY29uc3RydWN0b3IoeyBuYW1lRWxlbWVudFNlbGVjdG9yLCBhYm91dEVsZW1lbnRTZWxlY3Rvcn0pIHtcbiAgICAgICAgdGhpcy5fcHJvZmlsZU5hbWVFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihuYW1lRWxlbWVudFNlbGVjdG9yKTtcbiAgICAgICAgdGhpcy5fcHJvZmlsZUFib3V0TWVFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihhYm91dEVsZW1lbnRTZWxlY3Rvcik7XG4gICAgfVxuXG4gICAgZ2V0VXNlckluZm8gKCkge1xuICAgICAgICB0aGlzLl9jdXJyZW50VXNlckluZm8gPSB7XG4gICAgICAgICAgICBuYW1lOiB0aGlzLl9wcm9maWxlTmFtZUVsZW1lbnQudGV4dENvbnRlbnQsXG4gICAgICAgICAgICBhYm91dDogdGhpcy5fcHJvZmlsZUFib3V0TWVFbGVtZW50LnRleHRDb250ZW50XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiB0aGlzLl9jdXJyZW50VXNlckluZm87XG4gICAgfVxuXG4gICAgc2V0VXNlckluZm8gKG5hbWUsIGFib3V0KSB7XG4gICAgICAgIHRoaXMuX3Byb2ZpbGVOYW1lRWxlbWVudC50ZXh0Q29udGVudCA9IG5hbWU7XG4gICAgICAgIHRoaXMuX3Byb2ZpbGVBYm91dE1lRWxlbWVudC50ZXh0Q29udGVudCA9IGFib3V0O1xuICAgIH1cbn0iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBBcGkge1xuICAgIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcbiAgICAgICAgdGhpcy5fYmFzZVVybCA9IG9wdGlvbnMudXJsO1xuICAgICAgICB0aGlzLl9hdXRob3JpemF0aW9uID0gb3B0aW9ucy5hdXRob3JpemF0aW9uOyBcbiAgICB9XG4gICAgXG4gICAgbG9hZFVzZXJJbmZvKCkge1xuICAgICAgICBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcbiAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgICBhdXRob3JpemF0aW9uOiB0aGlzLl9hdXRob3JpemF0aW9uXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgICAgICAgIHJlcy5qc29uKClcbiAgICAgICAgfSlcbiAgICAgICAgLnRoZW4oKHJlc3VsdCkgPT4ge1xuICAgICAgICAgICAgY29uc29sZS5sb2cocmVzdWx0KVxuICAgICAgICB9KVxuICAgIH1cblxuICAgIGdldEluaXRpYWxDYXJkcygpIHtcbiAgICAgICAgXG4gICAgfVxufSIsImNvbnN0IGVkaXRQcm9maWxlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19pbmZvLWVkaXQtYnV0dG9uXCIpO1xuY29uc3QgZWRpdFByb2ZpbGVGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlLWVkaXQtZm9ybVwiKTtcblxuY29uc3QgbmFtZUZpZWxkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI25hbWUnKTtcbmNvbnN0IGFib3V0RmllbGQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjYWJvdXQtbWUnKTtcblxuY29uc3QgYWRkUG9zdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYWRkLWJ1dHRvblwiKTtcbmNvbnN0IGFkZFBvc3RGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5hZGQtcG9zdC1mb3JtXCIpO1xuXG5jb25zdCBpbml0aWFsQ2FyZHMgPSBbXG4gICAge1xuICAgICAgdGl0bGU6IFwiTGFnbyBkaSBCcmFpZXNcIixcbiAgICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvbGFnby5qcGdcIixcbiAgICB9LFxuICAgIHtcbiAgICAgIHRpdGxlOiBcIlZhbm9pc2UgTmF0aW9uYWwgUGFya1wiLFxuICAgICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS92YW5vaXNlLmpwZ1wiLFxuICAgIH0sXG4gICAge1xuICAgICAgdGl0bGU6IFwiTGF0ZW1hclwiLFxuICAgICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9sYXRlbWFyLmpwZ1wiLFxuICAgIH0sXG4gICAge1xuICAgICAgdGl0bGU6IFwiQmFsZCBNb3VudGFpbnNcIixcbiAgICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvYmFsZC1tb3VudGFpbnMuanBnXCIsXG4gICAgfSxcbiAgICB7XG4gICAgICB0aXRsZTogXCJMYWtlIExvdWlzZVwiLFxuICAgICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9sYWtlLWxvdWlzZS5qcGdcIixcbiAgICB9LFxuICAgIHtcbiAgICAgIHRpdGxlOiBcIllvc2VtaXRlIFZhbGxleVwiLFxuICAgICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS95b3NlbWl0ZS5qcGdcIixcbiAgICB9LFxuXTtcblxuY29uc3QgY2xhc3NlcyA9IHtcbiAgICBmb3JtU2VsZWN0b3I6IFwiLmZvcm1cIixcbiAgICBpbnB1dFNlbGVjdG9yOiBcIi5mb3JtX19pbnB1dFwiLFxuICAgIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5mb3JtX19zYXZlLWJ1dHRvblwiLFxuICAgIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwiZm9ybV9fc2F2ZS1idXR0b25fZGlzYWJsZWRcIixcbiAgICBpbnB1dEVycm9yQ2xhc3M6IFwiZm9ybV9faW5wdXRfdHlwZV9pbnZhbGlkXCIsXG4gICAgZXJyb3JDbGFzczogXCJmb3JtX19pbnB1dC1lcnJvcl9hY3RpdmVcIixcbn07XG5cbmNvbnN0IGxvZ29JbWFnZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjbG9nby1pbWFnZScpO1xuXG5jb25zdCBhdmF0YXJJbWFnZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjYXZhdGFyLWltYWdlJyk7XG5cbmNvbnN0IGluaXRpYWxQb3B1cEltYWdlRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNpbml0aWFsLXBvcHVwLWltYWdlJyk7XG5cbmV4cG9ydCB7IGVkaXRQcm9maWxlQnV0dG9uLCBlZGl0UHJvZmlsZUZvcm0sIG5hbWVGaWVsZCwgYWJvdXRGaWVsZCwgYWRkUG9zdEJ1dHRvbiwgYWRkUG9zdEZvcm0sIGluaXRpYWxDYXJkcywgY2xhc3NlcywgXG4gIGxvZ29JbWFnZUVsZW1lbnQsIGF2YXRhckltYWdlRWxlbWVudCwgaW5pdGlhbFBvcHVwSW1hZ2VFbGVtZW50fSIsIi8vIGxvYWQgc3R5bGVzaGVldHNcbmltcG9ydCAnLi4vcGFnZXMvaW5kZXguY3NzJztcblxuLy8gbG9hZCBpbWFnZXMgXG5pbXBvcnQgbG9nb0ltYWdlRmlsZSBmcm9tICcuLi9pbWFnZXMvbG9nby5zdmcnOyBcbmltcG9ydCBhdmF0YXJJbWFnZUZpbGUgZnJvbSAnLi4vaW1hZ2VzL2F2YXRhci5qcGcnO1xuaW1wb3J0IGluaXRpYWxQb3B1cEltYWdlRmlsZSBmcm9tICcuLi9pbWFnZXMvbGF0ZW1hci5qcGcnO1xuXG5pbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcbmltcG9ydCB1c2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xuaW1wb3J0IEFwaSBmcm9tIFwiLi4vY29tcG9uZW50cy9BcGkuanNcIjsgXG5cbmltcG9ydCB7IGVkaXRQcm9maWxlQnV0dG9uLCBlZGl0UHJvZmlsZUZvcm0sIG5hbWVGaWVsZCwgYWJvdXRGaWVsZCwgYWRkUG9zdEJ1dHRvbiwgYWRkUG9zdEZvcm0sIGluaXRpYWxDYXJkcywgY2xhc3NlcywgXG4gIGxvZ29JbWFnZUVsZW1lbnQsIGF2YXRhckltYWdlRWxlbWVudCwgaW5pdGlhbFBvcHVwSW1hZ2VFbGVtZW50fSBmcm9tICcuLi91dGlscy9jb25zdGFudHMuanMnOyBcblxuXG4vLyBsb2FkIGluaXRpYWwgY2FyZHNcbmNvbnN0IGltYWdlUG9wdXAgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoXCIjZm9jdXMtaW1hZ2UtcG9wdXBcIik7XG5pbWFnZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmZ1bmN0aW9uIGNyZWF0ZUNhcmQgKGRhdGEpIHtcbiAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKGRhdGEsIFwiLnRlbXBsYXRlX19wb3N0XCIsIChuYW1lLCBsaW5rKSA9PiB7XG4gICAgaW1hZ2VQb3B1cC5vcGVuKG5hbWUsIGxpbmspO1xuICB9KVxuICBjb25zdCBjYXJkRWxlbWVudCA9IGNhcmQuY3JlYXRlUG9zdCgpO1xuICByZXR1cm4gY2FyZEVsZW1lbnQ7XG59XG5cbmNvbnN0IGNhcmRTZWN0aW9uID0gbmV3IFNlY3Rpb24oXG4gIHtcbiAgICBpdGVtczogaW5pdGlhbENhcmRzLFxuICAgIHJlbmRlcmVyOiAoZGF0YSkgPT4ge1xuICAgICAgY29uc3QgZWxlbWVudCA9IGNyZWF0ZUNhcmQoZGF0YSk7XG4gICAgICBjYXJkU2VjdGlvbi5hZGRJdGVtKGVsZW1lbnQpO1xuICAgIH0sXG4gIH0sXG4gIFwiLnBvc3RzLWdyaWRcIlxuKTtcbmNhcmRTZWN0aW9uLnJlbmRlckVsZW1lbnRzKCk7XG5cblxuLy8gdmFpZGF0ZSBmb3Jtc1xuY29uc3QgYWRkUG9zdFZhbGlkYXRpb24gPSBuZXcgRm9ybVZhbGlkYXRvcihjbGFzc2VzLCBhZGRQb3N0Rm9ybSk7XG5hZGRQb3N0VmFsaWRhdGlvbi5lbmFibGVWYWxpZGF0aW9uKCk7XG5jb25zdCBlZGl0UHJvZmlsZVZhbGlkYXRpb24gPSBuZXcgRm9ybVZhbGlkYXRvcihjbGFzc2VzLCBlZGl0UHJvZmlsZUZvcm0pO1xuZWRpdFByb2ZpbGVWYWxpZGF0aW9uLmVuYWJsZVZhbGlkYXRpb24oKTtcblxuXG4vLyBjcmVhdGUgcG9wdXAgaW5zdGFuY2VzXG5jb25zdCBlZGl0UHJvZmlsZVBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXCIjZWRpdC1wcm9maWxlLXBvcHVwXCIsIGhhbmRsZVNhdmVQcm9maWxlQ2hhbmdlcyk7XG5lZGl0UHJvZmlsZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5jb25zdCBhZGRQb3N0UG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcIiNhZGQtcG9zdC1wb3B1cFwiLCBoYW5kbGVDcmVhdGVQb3N0KTtcbmFkZFBvc3RQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuXG5cbi8vIGVkaXQgcHJvZmlsZVxuY29uc3QgdXNlciA9IG5ldyB1c2VySW5mbyAoe1xuICBuYW1lRWxlbWVudFNlbGVjdG9yOiAnLnByb2ZpbGVfX2luZm8tbmFtZScsIFxuICBhYm91dEVsZW1lbnRTZWxlY3RvcjogJy5wcm9maWxlX19pbmZvLWRlc2NyaXB0b3InfSk7XG5cbmZ1bmN0aW9uIHNldEluaXRhbEZvcm1GaWVsZHMoKSB7XG4gIGNvbnN0IGN1cnJlbnRVc2VySW5mbyA9IHVzZXIuZ2V0VXNlckluZm8oKTtcbiAgbmFtZUZpZWxkLnZhbHVlID0gY3VycmVudFVzZXJJbmZvLm5hbWU7XG4gIGFib3V0RmllbGQudmFsdWUgPSBjdXJyZW50VXNlckluZm8uYWJvdXQ7IFxufVxuXG5mdW5jdGlvbiBoYW5kbGVFZGl0UHJvZmlsZSAoKSB7XG4gIGVkaXRQcm9maWxlUG9wdXAub3BlbigpO1xuICBzZXRJbml0YWxGb3JtRmllbGRzKCk7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZVNhdmVQcm9maWxlQ2hhbmdlcyhldmVudCkge1xuICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICBjb25zdCB1c2VyRm9ybURhdGEgPSBlZGl0UHJvZmlsZVBvcHVwLmdldElucHV0VmFsdWVzKCk7XG4gIHVzZXIuc2V0VXNlckluZm8odXNlckZvcm1EYXRhLm5hbWUsIHVzZXJGb3JtRGF0YVsnYWJvdXQtbWUnXSk7XG4gIGVkaXRQcm9maWxlUG9wdXAuY2xvc2UoKTsgXG59XG5cblxuLy8gYWRkIHBvc3RcbmZ1bmN0aW9uIGhhbmRsZUFkZFBvc3QoKSB7XG4gIGFkZFBvc3RQb3B1cC5vcGVuKCk7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZUNyZWF0ZVBvc3QoZXZlbnQpIHtcbiAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgY29uc3QgcG9zdEZvcm1EYXRhID0gYWRkUG9zdFBvcHVwLmdldElucHV0VmFsdWVzKCk7XG4gIGNvbnN0IGVsZW1lbnQgPSBjcmVhdGVDYXJkKHBvc3RGb3JtRGF0YSk7XG4gIGNhcmRTZWN0aW9uLmFkZEl0ZW0oZWxlbWVudCk7XG4gIGFkZFBvc3RQb3B1cC5jbG9zZSgpO1xufVxuXG4vLyBzZXQgZXZlbnQgbGlzdGVuZXJzXG5hZGRQb3N0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGFkZFBvc3RWYWxpZGF0aW9uLnJlc2V0VmFsaWRhdGlvbigpO1xuICBoYW5kbGVBZGRQb3N0KCk7XG59KTtcbmVkaXRQcm9maWxlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGVkaXRQcm9maWxlVmFsaWRhdGlvbi5yZXNldFZhbGlkYXRpb24oKTtcbiAgaGFuZGxlRWRpdFByb2ZpbGUoKTtcbn0pO1xuXG5cbi8vc2V0IGltYWdlc1xubG9nb0ltYWdlRWxlbWVudC5zcmMgPSBsb2dvSW1hZ2VGaWxlO1xuYXZhdGFySW1hZ2VFbGVtZW50LnNyYyA9IGF2YXRhckltYWdlRmlsZTsgXG5pbml0aWFsUG9wdXBJbWFnZUVsZW1lbnQuc3JjID0gaW5pdGlhbFBvcHVwSW1hZ2VGaWxlOyBcblxuY29uc3QgYXBpID0gbmV3IEFwaSh7dXJsOiAnaHR0cHM6Ly9hcm91bmQubm9tb3JlcGFydGllcy5jby92MS9ncm91cC0xMicsIGF1dGhvcml6YXRpb246ICczODI5MzRlOS01ZDEzLTQ2YjgtODg5Mi0xM2U4ZjEzZDU3ZmYnfSkiXSwibmFtZXMiOlsiX193ZWJwYWNrX3JlcXVpcmVfXyIsIkNhcmQiLCJkYXRhIiwidGVtcGxhdGVTZWxlY3RvciIsImhhbmRsZUNhcmRDbGljayIsIl9wb3N0IiwicmVtb3ZlIiwiZXZlbnQiLCJ0YXJnZXQiLCJjbGFzc0xpc3QiLCJ0b2dnbGUiLCJ0aGlzIiwiX3RpdGxlIiwidGl0bGUiLCJfbGluayIsImxpbmsiLCJfaGFuZGxlQ2FyZENsaWNrIiwiX3Bvc3RUZW1wbGF0ZUVsZW1lbnQiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJfcG9zdFRlbXBsYXRlIiwiY29udGVudCIsIl9wb3N0RWxlbWVudCIsImNsb25lTm9kZSIsIl9nZXRUZW1wbGF0ZSIsIl9wb3N0SW1hZ2VFbGVtZW50Iiwic2V0QXR0cmlidXRlIiwiX3Bvc3RDYXB0aW9uVGV4dEVsZW1lbnQiLCJ0ZXh0Q29udGVudCIsIl9zZXRFdmVudExpc3RlbmVycyIsIl9kZWxldGVCdXR0b24iLCJhZGRFdmVudExpc3RlbmVyIiwiX2hhbmRsZURlbGV0ZSIsIl9pbWFnZSIsIl9saWtlQnV0dG9uIiwiX2hhbmRsZUxpa2UiLCJGb3JtVmFsaWRhdG9yIiwic2V0dGluZ3MiLCJmb3JtRWxlbWVudCIsImlucHV0RWxlbWVudCIsImVycm9yTWVzc2FnZSIsImVycm9yTWVzc2FnZUVsZW1lbnQiLCJfZm9ybUVsZW1lbnQiLCJpZCIsImFkZCIsIl9pbnB1dEVycm9yQ2xhc3MiLCJfZXJyb3JDbGFzcyIsInZhbGlkaXR5IiwidmFsaWQiLCJfaGlkZUlucHV0RXJyb3IiLCJfc2hvd0lucHV0RXJyb3IiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsIl9mb3JtSW5wdXRzIiwic29tZSIsImlucHV0IiwidG9nZ2xlU3VibWl0QnV0dG9uIiwiZm9yRWFjaCIsIl9oYXNJbnZhbGlkSW5wdXQiLCJfc3VibWl0QnV0dG9uIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJyZW1vdmVBdHRyaWJ1dGUiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwiZXZ0IiwicHJldmVudERlZmF1bHQiLCJfaW5wdXRTZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJfc3VibWl0QnV0dG9uU2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsIlNlY3Rpb24iLCJjb250YWluZXJTZWxlY3RvciIsIml0ZW1zIiwicmVuZGVyZXIiLCJfaXRlbXMiLCJpdGVtIiwiX3JlbmRlcmVyIiwiZWxlbWVudCIsIl9jb250YWluZXIiLCJwcmVwZW5kIiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwiY3VycmVudFRhcmdldCIsImNsb3NlIiwia2V5IiwiX3BvcHVwU2VsZWN0b3IiLCJfcG9wdXBFbGVtZW50IiwiX2Nsb3NlQnV0dG9uIiwiX2hhbmRsZUVzY0Nsb3NlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsIl9oYW5kbGVPdmVybGF5Q2xpY2siLCJQb3B1cFdpdGhJbWFnZSIsIm5hbWUiLCJfaW1hZ2VDYXB0aW9uIiwiX3NldEltYWdlUG9wdXBBdHRyaWJ1dGVzIiwiUG9wdXBXaXRoRm9ybSIsInN1Ym1pdEhhbmRsZXIiLCJfdXNlcklucHV0cyIsIl9pbnB1dEZpZWxkcyIsInZhbHVlIiwiX2Zvcm0iLCJyZXNldCIsIl9zdWJtaXRIYW5kbGVyIiwidXNlckluZm8iLCJuYW1lRWxlbWVudFNlbGVjdG9yIiwiYWJvdXRFbGVtZW50U2VsZWN0b3IiLCJfcHJvZmlsZU5hbWVFbGVtZW50IiwiX3Byb2ZpbGVBYm91dE1lRWxlbWVudCIsIl9jdXJyZW50VXNlckluZm8iLCJhYm91dCIsIkFwaSIsIm9wdGlvbnMiLCJfYmFzZVVybCIsInVybCIsIl9hdXRob3JpemF0aW9uIiwiYXV0aG9yaXphdGlvbiIsImZldGNoIiwiaGVhZGVycyIsInRoZW4iLCJyZXMiLCJqc29uIiwicmVzdWx0IiwiY29uc29sZSIsImxvZyIsImVkaXRQcm9maWxlQnV0dG9uIiwiZWRpdFByb2ZpbGVGb3JtIiwibmFtZUZpZWxkIiwiYWJvdXRGaWVsZCIsImFkZFBvc3RCdXR0b24iLCJhZGRQb3N0Rm9ybSIsImNsYXNzZXMiLCJmb3JtU2VsZWN0b3IiLCJsb2dvSW1hZ2VFbGVtZW50IiwiYXZhdGFySW1hZ2VFbGVtZW50IiwiaW5pdGlhbFBvcHVwSW1hZ2VFbGVtZW50IiwiaW1hZ2VQb3B1cCIsImNyZWF0ZUNhcmQiLCJvcGVuIiwiY3JlYXRlUG9zdCIsInNldEV2ZW50TGlzdGVuZXJzIiwiY2FyZFNlY3Rpb24iLCJhZGRJdGVtIiwicmVuZGVyRWxlbWVudHMiLCJhZGRQb3N0VmFsaWRhdGlvbiIsImVuYWJsZVZhbGlkYXRpb24iLCJlZGl0UHJvZmlsZVZhbGlkYXRpb24iLCJlZGl0UHJvZmlsZVBvcHVwIiwidXNlckZvcm1EYXRhIiwiZ2V0SW5wdXRWYWx1ZXMiLCJ1c2VyIiwic2V0VXNlckluZm8iLCJhZGRQb3N0UG9wdXAiLCJyZXNldFZhbGlkYXRpb24iLCJjdXJyZW50VXNlckluZm8iLCJnZXRVc2VySW5mbyIsInNyYyIsImxvZ29JbWFnZUZpbGUiLCJhdmF0YXJJbWFnZUZpbGUiLCJpbml0aWFsUG9wdXBJbWFnZUZpbGUiXSwic291cmNlUm9vdCI6IiJ9